<script src="../../product/product.ts"></script>
<div class="row">
  <div class="col-12">
    <h2>Bills</h2>
  </div>
  <div class="col-12" *ngIf="customer$">
    <p>Bills for customer : <b>{{(customer$ |async)?.name}}</b> </p>
  </div>


    <div class="col-12" id="search">

      <form id="search-form" [formGroup]="billSearchForm">
        <div class="row align-items-center">

          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker1" placeholder="Bill created after" formControlName="orderCreationDateFrom" name="orderCreationDateFrom"/>
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker2" placeholder="Bill created before" formControlName="orderCreationDateTo" name="orderCreationDateTo"/>
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>

          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker1" placeholder="Deadline after" formControlName="orderCreationDateFrom" name="orderCreationDateFrom"/>
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker2" placeholder="Deadline before" formControlName="orderCreationDateTo" name="orderCreationDateTo"/>
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>

          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker1" placeholder="Note created after" formControlName="orderCreationDateFrom" name="orderCreationDateFrom"/>
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker2" placeholder="Note created before" formControlName="orderCreationDateTo" name="orderCreationDateTo"/>
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>

          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker2" placeholder="PO created before" formControlName="orderCreationDateTo" name="orderCreationDateTo"/>
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker2" placeholder="PO created before" formControlName="orderCreationDateTo" name="orderCreationDateTo"/>
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>

          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker1" placeholder="To be deliver after" formControlName="orderCreationDateFrom" name="orderCreationDateFrom"/>
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="form-group col-3">
            <mat-form-field>
              <input matInput [matDatepicker]="picker2" placeholder="To be deliver before" formControlName="orderCreationDateTo" name="orderCreationDateTo"/>
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>

          <div class="form-group col-3">
            <select data-filter="model" class="filter-model filter form-control">
              <option value="">Payment Status</option>
              <option value="">Show All</option>
            </select>
          </div>
          <div class="form-group col-3">
            <select data-filter="model" class="filter-model filter form-control">
              <option value="">Payment Method</option>
              <option value="">Show All</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="form-group col-3">
            <input class="form-control" formControlName="customerNameCSV" type="text" placeholder="Discount value" />
          </div>

          <div class="form-group col-3">
            <input class="form-control" formControlName="customerNameCSV" type="text" placeholder="Note Id" />
          </div>
          <div class="form-group col-3">
            <input class="form-control" formControlName="customerNameCSV" type="text" placeholder="PO Id" />
          </div>
          <div class="form-group col-3">
            <input class="form-control" formControlName="customerNameCSV" type="text" placeholder="Bill Id" />
          </div>
          <div class="form-group col-9">
            <input class="form-control" formControlName="customerNameCSV" type="text" placeholder="Customer name" />
          </div>
          <div class="form-group col-3 ">
            <button type="button" class="btn btn-block btn-primary" (click)="findBills()"><fa-icon icon="search"></fa-icon></button>
          </div>
        </div>

      </form>

    </div>


  <div class="col-12">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Bill Id</th>
          <th>Purchase order Id</th>
          <th>Delivery note Id</th>
          <th>Deadline</th>
          <th>Discount</th>
          <th>Creation date</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let bill of billTable$ | async" [shAttachMenu]="billMenu" [shMenuData]="bill">
          <td>{{bill.billId}}</td>
          <td>{{bill.purchaseOrderId}}</td>
          <td>{{bill.deliveryNoteId}}</td>
          <td>{{bill.deadLine | date}}</td>
          <td>{{bill.discount}} %</td>
          <td>{{bill.creationDate | date}}</td>
          <td class="text-center">
            <button mat-stroked-button color="primary" (click)="viewBill(bill.billId)" class="mr-2 mb-2"><fa-icon icon="eye"></fa-icon></button>
            <button mat-stroked-button color="primary" (click)="generateBill(bill.billId)" class="mr-2 mb-2">Generate bill</button>
            <button mat-stroked-button color="primary" (click)="sendBillByEmail(bill.billId)" class="mr-2 mb-2">Send by Email</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<sh-context-menu #billMenu>
  <ng-template shContextMenuItem (click)="viewBill($event.data.billId)">
    <div>View bill</div>
  </ng-template>
  <ng-template shContextMenuItem (click)="generateBill($event.data.billId)">
    <div>Generate bill</div>
  </ng-template>
  <ng-template shContextMenuItem (click)="sendBillByEmail($event.data.billId)">
    <div>Send bill by Email</div>
  </ng-template>
</sh-context-menu>
